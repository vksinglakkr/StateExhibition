<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>State Exhibition — New Prosecution Laws 2024</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<style>
  body {
    background: linear-gradient(135deg, #e0f2fe 0%, #fef3c7 100%);
    font-family: 'Inter', sans-serif;
  }
  .fade-in { animation: fadeIn 0.8s ease-in-out; }
  @keyframes fadeIn { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }
</style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

<div class="w-full max-w-3xl bg-white rounded-2xl shadow-2xl fade-in">
  <div class="bg-gradient-to-r from-blue-800 to-indigo-600 text-white rounded-t-2xl p-6 text-center">
    <h1 class="text-2xl font-bold mb-2">State Exhibition on New Prosecution Laws – 2024</h1>
    <p class="text-blue-100">Interactive Chatbot powered by Google Gemini</p>
    <p class="text-sm mt-1">Last Modified: <span id="modDate"></span></p>
  </div>

  <div class="p-6 space-y-6">
    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Your Name</label>
      <input id="name" class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-blue-600 focus:border-blue-600 p-2" placeholder="e.g. Vinod Singla" />
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">Select a ready question</label>
      <div id="sampleQuestions" class="max-h-56 overflow-auto border rounded-lg p-3 space-y-2 bg-gray-50"></div>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-1">Or type your own question</label>
      <textarea id="question" rows="4" class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-blue-600 focus:border-blue-600 p-2" placeholder="Type your custom question..."></textarea>
    </div>

    <div class="flex items-center space-x-2">
      <span class="text-gray-700 font-medium">Answer Language:</span>
      <button class="langBtn px-3 py-1 bg-blue-700 text-white rounded-lg hover:bg-blue-800 transition" data-lang="English">English</button>
      <button class="langBtn px-3 py-1 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition" data-lang="Hindi">Hindi</button>
      <button class="langBtn px-3 py-1 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition" data-lang="Punjabi">Punjabi</button>
    </div>

    <div class="flex items-center space-x-4">
      <button id="submitBtn" class="flex items-center justify-center gap-2 bg-blue-700 text-white px-5 py-2 rounded-xl shadow hover:bg-blue-800 transition">
        <i data-lucide="send"></i> <span>Ask AI</span>
      </button>
      <button id="mainPageBtn" class="flex items-center justify-center gap-2 bg-gray-500 text-white px-5 py-2 rounded-xl shadow hover:bg-gray-600 transition">
        <i data-lucide="home"></i> <span>Main Page</span>
      </button>
      <span id="status" class="text-gray-500"></span>
    </div>
  </div>

  <div class="border-t p-4 text-center text-sm text-gray-600">
    © 2024 State Exhibition | Informational purpose only — not legal advice
  </div>
</div>

<div id="modal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50">
  <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 fade-in">
    <div class="flex justify-between items-center border-b px-5 py-3 bg-blue-700 text-white rounded-t-2xl">
      <h2 class="text-lg font-semibold flex items-center gap-2"><i data-lucide="message-circle"></i> AI Response</h2>
      <button id="closeModal" class="hover:text-gray-200"><i data-lucide="x"></i></button>
    </div>
    <div class="p-5 max-h-[70vh] overflow-y-auto">
      <p class="font-semibold text-gray-700 mb-2">Question:</p>
      <pre id="userQuestion" class="whitespace-pre-wrap text-gray-800 mb-4"></pre>
      <p class="font-semibold text-gray-700 mb-2">Answer:</p>
      <pre id="aiAnswer" class="whitespace-pre-wrap text-gray-800"></pre>
    </div>
    <div class="border-t p-4 flex justify-end gap-3">
      <button id="copyBtn" class="flex items-center gap-1 px-4 py-2 border rounded-lg hover:bg-gray-100 transition"><i data-lucide="copy"></i> Copy</button>
      <button id="mainPageModalBtn" class="flex items-center gap-1 px-4 py-2 border rounded-lg hover:bg-gray-100 transition"><i data-lucide="home"></i> Main Page</button>
      <button id="closeBtn" class="bg-blue-700 text-white px-5 py-2 rounded-lg hover:bg-blue-800 transition">Close</button>
    </div>
  </div>
</div>

<script>
lucide.createIcons();

const WEBHOOK_URL = 'https://poonamvinod.app.n8n.cloud/webhook/chatbotwithopenAi';

// Sample questions
const samples = [
  "What are the three new prosecution laws implemented since 2024?",
  "How have the new laws changed the FIR process?",
  "Are bail provisions modified under the new system?"
];
const container = document.getElementById('sampleQuestions');
samples.forEach((q,i)=>{
  const id='q'+i;
  const div=document.createElement('div');
  div.className='flex items-start';
  div.innerHTML=`<input type="radio" id="${id}" name="sampleQ" value="${q}" class="mt-1 text-blue-600 focus:ring-blue-600">
  <label for="${id}" class="ml-2 text-sm text-gray-700 cursor-pointer hover:text-blue-700">${q}</label>`;
  container.appendChild(div);
});
container.addEventListener('change', e=>{
  if(e.target.name==='sampleQ') document.getElementById('question').value=e.target.value;
});

// Modal
const modal=document.getElementById('modal');
const openModal=()=>modal.classList.remove('hidden');
const closeModal=()=>modal.classList.add('hidden');
document.getElementById('closeBtn').onclick=closeModal;
document.getElementById('closeModal').onclick=closeModal;
document.getElementById('mainPageBtn').onclick = () => { window.location.href='index.html'; }
document.getElementById('mainPageModalBtn').onclick = () => { window.location.href='index.html'; }

// Language buttons
let selectedLanguage='English';
document.querySelectorAll('.langBtn').forEach(btn=>{
  btn.addEventListener('click', function(){
    selectedLanguage=this.dataset.lang;
    document.querySelectorAll('.langBtn').forEach(b=>b.classList.replace('bg-blue-700','bg-gray-500'));
    this.classList.replace('bg-gray-500','bg-blue-700');
  });
});

// Last modified
document.getElementById('modDate').textContent = document.lastModified;

// Fetch AI response safely
document.getElementById('submitBtn').addEventListener('click', async ()=>{
  const name=document.getElementById('name').value.trim()||'Anonymous';
  const question=document.getElementById('question').value.trim();
  if(!question){ alert('Please select or type a question'); return; }

  document.getElementById('submitBtn').disabled=true;
  document.getElementById('status').textContent='Getting response...';

  try{
    const res=await fetch(WEBHOOK_URL,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({name,question,language:selectedLanguage})
    });

    let data;
    try {
      const text = await res.text();
      data = text ? JSON.parse(text) : { answer: "Partial or no response received. Try again." };
    } catch(err){
      data = { answer: "Partial or no response received. Try again." };
    }

    document.getElementById('userQuestion').textContent=question;
    document.getElementById('aiAnswer').textContent=data.answer;
    openModal();
  } catch(err){
    document.getElementById('aiAnswer').textContent='Error contacting AI Server: '+err.message;
    openModal();
  } finally{
    document.getElementById('submitBtn').disabled=false;
    document.getElementById('status').textContent='';
  }
});

// Copy
document.getElementById('copyBtn').onclick=()=>{
  navigator.clipboard.writeText(document.getElementById('aiAnswer').textContent);
  alert('Copied to clipboard');
};
</script>
</body>
</html>

