<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>State Exhibition — New Criminal Laws 2024</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #e0f2fe 0%, #fef3c7 100%);
      font-family: 'Inter', sans-serif;
    }
    .fade-in {
      animation: fadeIn 0.6s ease-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .card-shadow {
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
    }
    .sample-question {
      transition: all 0.2s ease;
      border-left: 3px solid transparent;
    }
    .sample-question:hover {
      background-color: #f0f9ff;
      border-left-color: #3b82f6;
    }
    .language-btn.active {
      transform: scale(1.05);
      box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3);
    }
    .pulse {
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
      100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
    }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">
  <div class="w-full max-w-3xl bg-white rounded-2xl card-shadow overflow-hidden">
    <!-- Header -->
    <div class="bg-gradient-to-r from-blue-800 to-indigo-600 text-white p-6 text-center relative">
      <div class="absolute top-4 right-4 bg-yellow-400 text-blue-900 text-xs font-bold px-2 py-1 rounded-full">
        Official
      </div>
      <h1 class="text-2xl font-bold mb-1">State Exhibition on New Criminal Laws</h1>
      <p class="text-blue-100 text-sm">Bharatiya Nyaya Sanhita (BNS) • BNSS • BSA</p>
      <div class="mt-3 flex items-center justify-center text-xs bg-blue-700/30 px-3 py-1 rounded-full">
        <i data-lucide="cpu" class="w-3 h-3 mr-1"></i>
        AI Powered by Groq + Llama 3.3
      </div>
    </div>

    <!-- Info Banner -->
    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mx-6 mt-4">
      <div class="flex">
        <i data-lucide="info" class="text-blue-600 mt-0.5 mr-2 flex-shrink-0"></i>
        <p class="text-sm text-blue-800">
          This chatbot provides information about India's three new criminal laws (2024). 
          Responses are for informational purposes only and not legal advice.
        </p>
      </div>
    </div>

    <!-- Form -->
    <div class="p-6 space-y-5">
      <!-- Name Field -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
          <i data-lucide="user" class="w-4 h-4 mr-2"></i>
          Your Name (Optional)
        </label>
        <input 
          id="name" 
          class="w-full rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 p-3 text-gray-800 transition"
          placeholder="e.g., Rajesh Kumar"
        />
      </div>

      <!-- Sample Questions -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
          <i data-lucide="book-open" class="w-4 h-4 mr-2"></i>
          Quick Questions
        </label>
        <div id="sampleQuestions" class="max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3 space-y-2 bg-gray-50"></div>
      </div>

      <!-- Custom Question -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
          <i data-lucide="message-circle" class="w-4 h-4 mr-2"></i>
          Your Question
        </label>
        <textarea 
          id="question" 
          rows="3" 
          class="w-full rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 p-3 text-gray-800 transition"
          placeholder="Ask about BNS, BNSS, or BSA..."
        ></textarea>
      </div>

      <!-- Language Selector -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
          <i data-lucide="globe" class="w-4 h-4 mr-2"></i>
          Response Language
        </label>
        <div class="flex flex-wrap gap-2">
          <button class="langBtn px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition active" data-lang="English">
            English
          </button>
          <button class="langBtn px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition" data-lang="Hindi">
            हिंदी
          </button>
          <button class="langBtn px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition" data-lang="Punjabi">
            ਪੰਜਾਬੀ
          </button>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-wrap gap-3 pt-2">
        <button id="submitBtn" class="flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-5 py-3 rounded-xl shadow-md transition flex-1 min-w-[140px] pulse">
          <i data-lucide="send" class="w-4 h-4"></i> Ask AI
        </button>
        
        <button id="voiceBtn" class="flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white px-5 py-3 rounded-xl shadow-md transition flex-1 min-w-[140px]">
          <i data-lucide="mic" class="w-4 h-4"></i> Speak
        </button>
        
        <button id="mainPageBtn" class="flex items-center justify-center gap-2 bg-gray-600 hover:bg-gray-700 text-white px-5 py-3 rounded-xl shadow-md transition flex-1 min-w-[140px]">
          <i data-lucide="home" class="w-4 h-4"></i> Home
        </button>
      </div>
      
      <div id="status" class="text-center text-gray-500 min-h-[20px]"></div>
    </div>

    <!-- Footer -->
    <div class="border-t border-gray-200 p-4 text-center text-sm text-gray-600">
      <div class="mb-1">
        <span class="font-medium">Developed & Maintained by:</span><br>
        <span class="text-blue-700">NIC, Kurukshetra</span> for District Administration, Kurukshetra
      </div>
      <div class="flex items-center justify-center mt-2">
        <i data-lucide="shield-check" class="w-4 h-4 mr-1 text-green-600"></i>
        <span>© 2024 State Exhibition | Informational Purpose Only</span>
      </div>
      <div class="mt-2 text-xs text-gray-500">
        Last Updated: <span id="lastUpdated">June 2024</span>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="modal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
    <div class="bg-white rounded-2xl card-shadow w-full max-w-2xl fade-in">
      <div class="flex justify-between items-center border-b border-gray-200 px-6 py-4 bg-gradient-to-r from-blue-700 to-indigo-600 text-white rounded-t-2xl">
        <h2 class="text-lg font-semibold flex items-center gap-2">
          <i data-lucide="message-circle" class="w-5 h-5"></i> AI Response
        </h2>
        <button id="closeModal" class="hover:text-gray-200">
          <i data-lucide="x" class="w-5 h-5"></i>
        </button>
      </div>
      
      <div class="p-6 max-h-[65vh] overflow-y-auto">
        <div class="mb-6">
          <div class="flex items-start mb-3">
            <div class="bg-blue-100 p-2 rounded-lg mr-3">
              <i data-lucide="user" class="w-4 h-4 text-blue-600"></i>
            </div>
            <div>
              <p class="font-medium text-gray-700 mb-1">Your Question</p>
              <p id="userQuestion" class="text-gray-800 bg-gray-50 p-3 rounded-lg"></p>
            </div>
          </div>
          
          <div class="flex items-start">
            <div class="bg-indigo-100 p-2 rounded-lg mr-3">
              <i data-lucide="cpu" class="w-4 h-4 text-indigo-600"></i>
            </div>
            <div>
              <p class="font-medium text-gray-700 mb-1">AI Response</p>
              <div id="aiAnswer" class="text-gray-800 bg-indigo-50 p-3 rounded-lg whitespace-pre-wrap"></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="border-t border-gray-200 p-4 flex flex-wrap gap-3 justify-end">
        <button id="copyBtn" class="flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">
          <i data-lucide="copy" class="w-4 h-4"></i> Copy Response
        </button>
        <button id="mainPageModalBtn" class="flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">
          <i data-lucide="home" class="w-4 h-4"></i> Home
        </button>
        <button id="closeBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-lg transition">
          Close
        </button>
      </div>
    </div>
  </div>

  <script>
    lucide.createIcons();

    // Update last updated date dynamically
    document.getElementById('lastUpdated').textContent = new Date().toLocaleDateString('en-US', { 
      year: 'numeric', 
      month: 'long' 
    });

    const WEBHOOK_URL = 'https://aarvisingla1609.app.n8n.cloud/webhook/ai-answer';

    const samples = [
      "What are the three new criminal laws implemented in 2024?",
      "How has the FIR process changed under BNSS?",
      "What are the new bail provisions in BNS?",
      "How are cybercrimes handled under the new laws?",
      "What changes exist in evidence collection?",
      "Do victims get faster justice now?",
      "Are new offences introduced in BNS?",
      "How do the laws ensure speedy trials?",
      "Do these laws affect existing criminal cases?",
      "What are the changes to police arrest powers?",
      "How are economic crimes handled differently?",
      "Is digital evidence submission allowed?",
      "What are the main benefits for citizens?",
      "How do these laws support fair prosecution?",
      "What are the penalties for investigation delays?",
      "Where can I access the official law texts?",
      "How do these laws align with constitutional rights?",
      "What is Bharatiya Nyaya Sanhita (BNS)?",
      "What is Bharatiya Nagarik Suraksha Sanhita (BNSS)?",
      "What is Bharatiya Sakshya Adhiniyam (BSA)?"
    ];

    const container = document.getElementById('sampleQuestions');
    samples.forEach((q, i) => {
      const id = `q${i}`;
      const div = document.createElement('div');
      div.className = 'sample-question p-2 rounded cursor-pointer';
      div.innerHTML = `
        <input type="radio" id="${id}" name="sampleQ" value="${q}" class="sr-only">
        <label for="${id}" class="block text-sm text-gray-700">${q}</label>
      `;
      container.appendChild(div);
      
      div.addEventListener('click', () => {
        document.getElementById('question').value = q;
        // Highlight selected question
        document.querySelectorAll('.sample-question').forEach(el => el.classList.remove('bg-blue-50', 'border-l-blue-500'));
        div.classList.add('bg-blue-50', 'border-l-blue-500');
      });
    });

    // Modal functions
    const modal = document.getElementById('modal');
    const openModal = () => modal.classList.remove('hidden');
    const closeModal = () => modal.classList.add('hidden');
    
    document.getElementById('closeBtn').onclick = closeModal;
    document.getElementById('closeModal').onclick = closeModal;
    document.getElementById('mainPageBtn').onclick = () => window.location.href = 'index.html';
    document.getElementById('mainPageModalBtn').onclick = () => window.location.href = 'index.html';

    // Language selection
    let selectedLanguage = 'English';
    document.querySelectorAll('.langBtn').forEach(btn => {
      btn.addEventListener('click', function() {
        selectedLanguage = this.dataset.lang;
        document.querySelectorAll('.langBtn').forEach(b => {
          b.classList.remove('bg-blue-600', 'active');
          b.classList.add('bg-gray-600');
        });
        this.classList.remove('bg-gray-600');
        this.classList.add('bg-blue-600', 'active');
      });
    });

    // Submit handler
    document.getElementById('submitBtn').addEventListener('click', async () => {
      const name = document.getElementById('name').value.trim() || 'Visitor';
      const question = document.getElementById('question').value.trim();
      if (!question) {
        alert('Please enter a question');
        return;
      }

      document.getElementById('submitBtn').disabled = true;
      document.getElementById('status').textContent = 'Getting response...';

      try {
        const res = await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name, question, language: selectedLanguage })
        });

        let answerText = '';
        if (res.ok) {
          const data = await res.json();
          answerText = data.answer || data.error || "No answer received.";
        } else {
          answerText = `Error: ${res.status} ${res.statusText}`;
        }

        document.getElementById('userQuestion').textContent = question;
        document.getElementById('aiAnswer').textContent = answerText;
        openModal();
      } catch (err) {
        alert('Connection failed: ' + err.message);
      } finally {
        document.getElementById('submitBtn').disabled = false;
        document.getElementById('status').textContent = '';
      }
    });

    // Voice Input Setup
    let recognition;
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SpeechRecognition();
      recognition.continuous = false;
      recognition.interimResults = false;

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        document.getElementById('question').value = transcript;
        document.getElementById('status').textContent = '';
        updateVoiceButton('mic', 'Speak');
      };

      recognition.onerror = (event) => {
        console.error('Voice error:', event.error);
        document.getElementById('status').textContent = 'Voice error: ' + event.error;
        updateVoiceButton('mic', 'Speak');
      };

      recognition.onend = () => {
        updateVoiceButton('mic', 'Speak');
      };
    }

    function updateVoiceButton(icon, text) {
      document.getElementById('voiceBtn').innerHTML = `<i data-lucide="${icon}" class="w-4 h-4"></i> <span>${text}</span>`;
      lucide.createIcons();
    }

    document.getElementById('voiceBtn').addEventListener('click', () => {
      if (!recognition) {
        alert('Voice input not supported. Try Chrome or Edge.');
        return;
      }

      const langMap = {
        'English': 'en-IN',
        'Hindi': 'hi-IN',
        'Punjabi': 'pa-IN'
      };
      recognition.lang = langMap[selectedLanguage] || 'en-IN';

      updateVoiceButton('mic-off', 'Listening...');
      document.getElementById('status').textContent = 'Listening... Speak now.';

      try {
        recognition.start();
      } catch (err) {
        console.error('Voice start error:', err);
        document.getElementById('status').textContent = 'Voice error: ' + err.message;
        updateVoiceButton('mic', 'Speak');
      }
    });

    // Copy button
    document.getElementById('copyBtn').onclick = () => {
      navigator.clipboard.writeText(document.getElementById('aiAnswer').textContent);
      // Show temporary success message
      const originalText = document.getElementById('copyBtn').innerHTML;
      document.getElementById('copyBtn').innerHTML = '<i data-lucide="check" class="w-4 h-4"></i> Copied!';
      lucide.createIcons();
      setTimeout(() => {
        document.getElementById('copyBtn').innerHTML = originalText;
        lucide.createIcons();
      }, 2000);
    };
  </script>
</body>
</html>
